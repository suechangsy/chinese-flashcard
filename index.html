<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Chinese Flashcard Generator</title>

<style>
body { font-family: Arial, "Noto Sans SC"; padding:20px; background:#f7f7f7; }
h1 { text-align:center; }
input, button { padding:6px 10px; font-size:16px; margin:5px; }
.flashcard { width:300px; margin:20px auto; padding:20px; border:2px solid #333; border-radius:10px; background:white; text-align:center; }
.flashcard h2 { font-size:36px; margin:10px 0; }
.pinyin { font-size:20px; color:#555; }
</style>

<!-- æ‹¼éŸ³åº“ -->
<script src="https://cdn.jsdelivr.net/npm/pinyin-pro@2.8.0/dist/pinyin-pro.min.js"></script>

<!-- PDF å¯¼å‡º -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

</head>
<body>

<h1>Chinese Flashcard Generator</h1>

<input id="wordInput" placeholder="è¾“å…¥ä¸­æ–‡è¯è¯­">
<button onclick="generateCard()">ç”Ÿæˆ Flashcard</button>

<div id="card-area"></div>

<div id="teacher-box" style="display:none; text-align:center;">
<h3>è€å¸ˆè¡¥å……è‹±æ–‡</h3>
<input id="teacher-en" placeholder="English translation">
<button onclick="saveTeacherTranslation()">ä¿å­˜</button>
</div>

<button onclick="exportPDF()">ğŸ“„ å¯¼å‡º A4 Flashcard PDF</button>

<script>
// ===== å†…ç½® HSK ç¤ºä¾‹æ•°æ® =====
const HSK = {
  "åƒé¥­": { "en": "to eat a meal", "level": 1 },
  "å–æ°´": { "en": "to drink water", "level": 1 },
  "çœ‹ä¹¦": { "en": "to read a book", "level": 1 },
  "å»å­¦æ ¡": { "en": "to go to school", "level": 1 },
  "ä¹°ä¸œè¥¿": { "en": "to buy things", "level": 2 },
  "å–èŒ¶": { "en": "to drink tea", "level": 1 },
  "å–œæ¬¢": { "en": "to like", "level": 1 },
  "æƒ³": { "en": "to want / to think", "level": 1 },
  "åœ¨": { "en": "to be at", "level": 1 }
};

let currentWord = "";

// ===== è‡ªåŠ¨æ‹¼éŸ³ =====
function getPinyin(word) {
  return pinyinPro.pinyin(word, { toneType: "symbol" });
}

// ===== ç”Ÿæˆå¡ç‰‡ =====
function generateCard() {
  const word = document.getElementById("wordInput").value.trim();
  if (!word) return;

  currentWord = word;
  let data = HSK[word];

  // è€å¸ˆè¡¥å……ä¼˜å…ˆ
  const saved = localStorage.getItem("custom_" + word);
  if (saved) data = JSON.parse(saved);

  const pinyinText = getPinyin(word);
  const enText = data ? data.en : "âš ï¸ è¯·è€å¸ˆè¡¥å……è‹±æ–‡";

  document.getElementById("card-area").innerHTML = `
    <div class="flashcard" id="flashcard">
      <h2>${word}</h2>
      <p class="pinyin" id="pinyin" style="display:none">${pinyinText}</p>
      <p>${enText}</p>
      <button onclick="togglePinyin()">æ‹¼éŸ³</button>
      <button onclick="speak()">ğŸ”Š</button>
    </div>
  `;

  document.getElementById("teacher-box").style.display =
    data ? "none" : "block";
}

// ===== æ˜¾ç¤º/éšè—æ‹¼éŸ³ =====
function togglePinyin() {
  const p = document.getElementById("pinyin");
  p.style.display = p.style.display === "none" ? "block" : "none";
}

// ===== ä¸­æ–‡æœ—è¯» =====
function speak() {
  const u = new SpeechSynthesisUtterance(currentWord);
  u.lang = "zh-CN";
  speechSynthesis.speak(u);
}

// ===== è€å¸ˆè¡¥å……è‹±æ–‡
